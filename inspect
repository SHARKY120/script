-- Sharky GUI Inspector - Optimized + Scrollable + Realtime + Sorted

local player = game.Players.LocalPlayer
local guiTargets = {
    player:FindFirstChild("PlayerGui"),
    game.CoreGui,
    game:GetService("StarterGui")
}

-- Hapus GUI sebelumnya
local old = game.CoreGui:FindFirstChild("SharkyOptimizedInspector")
if old then old:Destroy() end

-- GUI utama
local screenGui = Instance.new("ScreenGui", game.CoreGui)
screenGui.Name = "SharkyOptimizedInspector"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- ScrollFrame
local scrollingFrame = Instance.new("ScrollingFrame", screenGui)
scrollingFrame.Size = UDim2.new(0, 500, 0, 360)
scrollingFrame.Position = UDim2.new(0, 10, 0, 10)
scrollingFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
scrollingFrame.BackgroundTransparency = 0.2
scrollingFrame.BorderSizePixel = 0
scrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
scrollingFrame.ScrollBarThickness = 8
scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollingFrame.ClipsDescendants = true

-- Layout
local layout = Instance.new("UIListLayout", scrollingFrame)
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0, 2)

-- Reverse urutan: item baru di atas
layout.VerticalAlignment = Enum.VerticalAlignment.Bottom

-- Fungsi cetak isi GUI
local function scanGui(obj, indent, lines)
    indent = indent or ""
    lines = lines or {}

    table.insert(lines, indent .. obj.Name .. " [" .. obj.ClassName .. "]")

    if obj:IsA("TextLabel") or obj:IsA("TextButton") then
        table.insert(lines, indent .. "  Text: " .. (obj.Text or "[Kosong]"))
    elseif obj:IsA("ImageLabel") or obj:IsA("ImageButton") then
        table.insert(lines, indent .. "  Image: " .. (obj.Image or "[Kosong]"))
    end

    for _, child in ipairs(obj:GetChildren()) do
        scanGui(child, indent .. "  ", lines)
    end

    return lines
end

-- Bersihkan isi lama
local function clearOld()
    for _, v in ipairs(scrollingFrame:GetChildren()) do
        if v:IsA("TextLabel") then
            v:Destroy()
        end
    end
end

-- Tampilkan hasil
local function addLine(txt, color)
    local label = Instance.new("TextLabel", scrollingFrame)
    label.Size = UDim2.new(1, -10, 0, 18)
    label.BackgroundTransparency = 1
    label.Font = Enum.Font.Code
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Text = txt
    label.TextColor3 = color or Color3.new(1, 1, 1)
end

-- Update isi GUI
local function updateInspector()
    clearOld()

    for _, container in ipairs(guiTargets) do
        if container then
            for _, guiObj in ipairs(container:GetChildren()) do
                if guiObj:IsA("ScreenGui") then
                    addLine("ðŸ“¦ GUI: " .. guiObj.Name, Color3.fromRGB(255, 255, 0))
                    local lines = scanGui(guiObj, "  ")
                    for _, line in ipairs(lines) do
                        addLine(line)
                    end
                    addLine("")
                end
            end
        end
    end
end

-- Jalankan update awal
updateInspector()

-- Real-time: pantau semua perubahan
for _, container in ipairs(guiTargets) do
    if container then
        container.ChildAdded:Connect(function()
            task.delay(0.3, updateInspector)
        end)
        container.ChildRemoved:Connect(function()
            task.delay(0.3, updateInspector)
        end)

        for _, guiObj in ipairs(container:GetChildren()) do
            if guiObj:IsA("ScreenGui") then
                guiObj.DescendantAdded:Connect(function()
                    task.delay(0.3, updateInspector)
                end)
                guiObj.DescendantRemoving:Connect(function()
                    task.delay(0.3, updateInspector)
                end)
            end
        end
    end
end

print("âœ… Inspector aktif: scrollable, real-time, terurut (terbaru di atas)")
